<!-- MODAL DE VENTAS - Carrito Master-Detail -->
<div id="modalVenta" class="modal-overlay">
  <div class="modal-venta">
    <div class="modal-venta-header">
      <h2>üõí Registro de Venta</h2>
      <button class="close-modal" onclick="cerrarModalVenta()">&times;</button>
    </div>

    <form id="formVenta" onsubmit="registrarVentaDetallada(event)">
      <div class="modal-venta-body">

        <!-- SECCI√ìN: INFORMACI√ìN DEL VENDEDOR -->
        <div class="modal-section">
          <div class="modal-section-title">üë§ Informaci√≥n del Vendedor</div>
          <div class="form-grid">
            <div class="form-group">
              <label class="required-field">Nombre del Vendedor</label>
              <input type="text" id="ventaVendedor" placeholder="ej: Dylan Rizo" required>
            </div>
            <div class="form-group">
              <label>Persona que realiz√≥ la entrega</label>
              <input type="text" id="ventaEntregador" placeholder="ej: Jean">
            </div>
          </div>
        </div>

        <!-- SECCI√ìN: CANAL DE VENTA -->
        <div class="modal-section">
          <div class="modal-section-title">üì± Canal de Venta</div>
          <div class="form-grid">
            <div class="form-group">
              <label class="required-field">¬øPor d√≥nde te contact√≥ el cliente?</label>
              <select id="ventaCanalVenta" required>
                <option value="">Seleccione un canal...</option>
                <option value="Facebook Marketplace">Facebook Marketplace</option>
                <option value="WhatsApp">WhatsApp</option>
                <option value="Instagram">Instagram</option>
                <option value="TikTok">TikTok</option>
                <option value="Presencial/Local">Presencial/Local</option>
              </select>
            </div>
          </div>
        </div>

        <!-- SECCI√ìN: CARRITO DE PRODUCTOS -->
        <div class="modal-section">
          <div class="modal-section-title">üì¶ Productos Vendidos</div>

          <!-- Zona de inputs para agregar al carrito -->
          <div class="carrito-input-zone">
            <div class="carrito-input-row">
              <div class="form-group carrito-input-producto">
                <label class="required-field">Producto</label>
                <div class="autocomplete-venta-container">
                  <input type="text" id="carritoProductoInput" class="item-codigo-input"
                    placeholder="Buscar c√≥digo o nombre..." onkeyup="buscarProductoCarrito()"
                    onblur="setTimeout(() => ocultarAutocompleteCarrito(), 200)">
                  <div id="autocompleteCarrito" class="autocomplete-venta-dropdown"></div>
                </div>
              </div>
              <div class="form-group carrito-input-almacen">
                <label class="required-field">Almac√©n Origen</label>
                <select id="carritoAlmacenInput">
                  <option value="">Seleccione...</option>
                </select>
              </div>
              <div class="form-group carrito-input-precio">
                <label>Precio Unit.</label>
                <input type="number" id="carritoPrecioInput" min="0" step="0.01" placeholder="0.00">
              </div>
              <div class="form-group carrito-input-cantidad">
                <label class="required-field">Cantidad</label>
                <input type="number" id="carritoCantidadInput" min="0.01" step="0.01" placeholder="1">
              </div>
              <div class="form-group carrito-input-btn">
                <label>&nbsp;</label>
                <button type="button" class="btn btn-agregar-carrito" onclick="agregarAlCarrito()">
                  ‚ûï Agregar
                </button>
              </div>
            </div>
          </div>

          <!-- Tabla del carrito -->
          <div class="carrito-table-container">
            <table class="carrito-table">
              <thead>
                <tr>
                  <th>Producto</th>
                  <th>Almac√©n</th>
                  <th>Cant.</th>
                  <th>Precio Unit.</th>
                  <th>Subtotal</th>
                  <th>Acci√≥n</th>
                </tr>
              </thead>
              <tbody id="carritoBody">
                <tr id="carritoVacio">
                  <td colspan="6" style="text-align:center; color:#999; padding:20px;">
                    üõí Agrega productos al carrito usando el formulario de arriba
                  </td>
                </tr>
              </tbody>
              <tfoot>
                <tr class="carrito-total-row">
                  <td colspan="4" style="text-align:right; font-weight:700;">Subtotal Productos:</td>
                  <td id="carritoSubtotalDisplay" style="font-weight:700; color:#2E86AB;">$0.00</td>
                  <td></td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>

        <!-- SECCI√ìN: ENV√çO -->
        <div class="modal-section">
          <div class="modal-section-title">üöö Costo de Env√≠o</div>
          <div class="form-grid">
            <div class="form-group">
              <label>Env√≠o Cobrado</label>
              <input type="number" id="ventaEnvioCobrado" min="0" step="0.01" placeholder="0.00" value="0"
                onchange="actualizarTotalVenta()">
            </div>
            <div class="form-group">
              <label class="required-field">Lugar donde se hizo la entrega</label>
              <input type="text" id="ventaLugarEntrega" placeholder="ej: Casa del cliente, Oficina, etc." required>
            </div>
          </div>
        </div>

        <!-- SECCI√ìN: HORARIOS -->
        <div class="modal-section">
          <div class="modal-section-title">üïê Horarios de Entrega</div>
          <div class="form-grid">
            <div class="form-group">
              <label class="required-field">Hora de Salida</label>
              <input type="time" id="ventaHoraSalida" required>
            </div>
            <div class="form-group">
              <label>Hora de Finalizaci√≥n</label>
              <input type="time" id="ventaHoraFinalizacion">
            </div>
          </div>
        </div>

        <!-- SECCI√ìN: OBSERVACIONES -->
        <div class="modal-section">
          <div class="form-group">
            <label>Observaciones Adicionales</label>
            <textarea id="ventaObservaciones" rows="3" placeholder="Notas adicionales sobre la venta..."></textarea>
          </div>
        </div>

      </div>

      <div class="modal-venta-footer">
        <div class="total-venta-display">
          Total: $<span id="totalVentaDisplay">0.00</span>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary" onclick="cerrarModalVenta()">Cancelar</button>
          <button type="submit" class="btn btn-success">üíæ Registrar Venta</button>
        </div>
      </div>
    </form>
  </div>
</div>