<!-- DASHBOARD -->
<div id="dashboard" class="tab-content active">
  <div class="content-header">
    <h2>Dashboard General</h2>
  </div>
  <div class="content-body">
    <div class="stats-grid" id="statsGrid"></div>
    <div class="card">
      <div class="card-header">Alertas de Stock</div>
      <div class="card-body">
        <div class="actions">
          <button class="btn btn-primary" onclick="loadDashboard()">Actualizar</button>
          <button class="btn btn-warning" onclick="showStockAlerts()">Ver Alertas</button>
        </div>
        <div id="alertsContainer"></div>
      </div>
    </div>
  </div>
</div>

<!-- ENTRADA DE PRODUCTOS -->
<div id="entrada" class="tab-content">
  <div class="content-header">
    <h2>Entrada de Productos</h2>
  </div>
  <div class="content-body">
    <div class="card">
      <div class="card-header">Registrar Entrada de Producto</div>
      <div class="card-body">
        <form id="formEntrada" onsubmit="registrarEntrada(event)">
          <div class="form-grid">
            <div class="form-group">
              <label for="codigoEntrada">CÃ³digo del Producto *</label>
              <div class="autocomplete-container">
                <input id="codigoEntrada" type="text" placeholder="CÃ³digo" required onkeyup="buscarProductoEntrada()"
                  onblur="ocultarAutocompletadoEntrada()">
                <div id="autocompleteEntrada" class="autocomplete-dropdown"></div>
              </div>
            </div>
            <div class="form-group">
              <label for="nombreEntrada">Nombre *</label>
              <input id="nombreEntrada" type="text" placeholder="Nombre del producto" required>
            </div>
            <div class="form-group">
              <label for="unidadEntrada">Unidad de Medida *</label>
              <select id="unidadEntrada" required></select>
            </div>
            <div class="form-group">
              <label for="grupoEntrada">Grupo *</label>
              <select id="grupoEntrada" required></select>
            </div>
            <div class="form-group">
              <label for="cantidadEntrada">Cantidad *</label>
              <input id="cantidadEntrada" type="number" min="0.01" step="0.01" placeholder="Cantidad" required>
            </div>
            <div class="form-group">
              <label for="costoEntrada">Costo Unitario</label>
              <input id="costoEntrada" type="number" min="0" step="0.01" placeholder="Costo" value="0">
            </div>
            <div class="form-group">
              <label for="precioEntrada">Precio de Venta *</label>
              <input id="precioEntrada" type="number" min="0.01" step="0.01" placeholder="Precio" required>
            </div>
            <div class="form-group">
              <label for="stockMinEntrada">Stock MÃ­nimo</label>
              <input id="stockMinEntrada" type="number" min="0" value="0">
            </div>
            <div class="form-group">
              <label for="almacenEntrada">UbicaciÃ³n/Casa *</label>
              <select id="almacenEntrada" required></select>
            </div>
            <div class="form-group">
              <label for="descripcionEntrada">DescripciÃ³n</label>
              <textarea id="descripcionEntrada" placeholder="DescripciÃ³n del producto" rows="2"></textarea>
            </div>
          </div>
          <div class="actions">
            <button type="submit" class="btn btn-success">Registrar Entrada</button>
            <button type="button" class="btn btn-secondary" onclick="limpiarFormEntrada()">Limpiar</button>
          </div>
        </form>
        <div id="msgEntrada"></div>
      </div>
    </div>

    <!-- NUEVA SECCIÃ“N: ImportaciÃ³n Masiva desde CSV -->
    <div class="card" style="margin-top: 20px;">
      <div class="card-header">ğŸ“¤ ImportaciÃ³n Masiva desde CSV</div>
      <div class="card-body">
        <p style="margin-bottom: 15px; color: #666;">
          Sube un archivo CSV con la estructura de inventario para importar mÃºltiples productos y distribuir stock en
          los almacenes automÃ¡ticamente.
        </p>
        <div class="form-group">
          <label for="archivoCSV">Seleccionar archivo CSV *</label>
          <input type="file" id="archivoCSV" accept=".csv" style="display: block; margin-top: 8px;" />
        </div>
        <div class="actions">
          <button type="button" class="btn btn-primary" onclick="procesarImportacionCSV()">
            ğŸ“¥ Procesar ImportaciÃ³n
          </button>
          <button type="button" class="btn btn-secondary" onclick="limpiarImportacion()">
            ğŸ”„ Limpiar
          </button>
        </div>
        <div id="msgImportacion" style="margin-top: 15px;"></div>
        <div id="resultadoImportacion" style="margin-top: 15px;"></div>
      </div>
    </div>
  </div>
</div>

<!-- MOVIMIENTOS -->
<div id="movimientos" class="tab-content">
  <div class="content-header">
    <h2>Registro de Movimientos</h2>
  </div>
  <div class="content-body">

    <!-- âœ… AGREGAR AQUÃ: Botones de acciones rÃ¡pidas -->
    <div class="btn-group" style="margin-bottom: 20px; display: flex; gap: 10px;">
      <button type="button" class="btn btn-primary" onclick="abrirModalTransferencia()">
        ğŸ”„ Transferir Stock entre Ubicaciones
      </button>
      <button type="button" class="btn btn-success" onclick="abrirModalVenta()">
        ğŸ›’ Registrar Venta
      </button>
    </div>
    <!-- FIN: Botones de acciones rÃ¡pidas -->

    <div class="card">
      <div class="card-header">Nuevo Movimiento</div>
      <div class="card-body">
        <form id="formMovimiento" onsubmit="registrarMovimiento(event)">
          <div class="form-grid">
            <div class="form-group">
              <label for="codigoMov">CÃ³digo *</label>
              <div class="autocomplete-container">
                <input id="codigoMov" type="text" placeholder="CÃ³digo" required onkeyup="buscarProductoAutocompletado()"
                  onblur="ocultarAutocompletado()">
                <div id="autocompleteDropdown" class="autocomplete-dropdown"></div>
              </div>
            </div>
            <div class="form-group">
              <label for="fechaMov">Fecha *</label>
              <input id="fechaMov" type="date" required>
            </div>
            <div class="form-group">
              <label for="tipoMov">Tipo *</label>
              <select id="tipoMov" required onchange="handleTipoChange()">
                <option value="SALIDA">Salida</option>
                <option value="VENTA">Venta</option>
                <option value="TRANSFERENCIA">Transferencia entre ubicaciones</option>
                <option value="AJUSTE_POSITIVO">Ajuste +</option>
                <option value="AJUSTE_NEGATIVO">Ajuste -</option>
              </select>
            </div>
            <div class="form-group">
              <label for="cantMov">Cantidad *</label>
              <input id="cantMov" type="number" min="0.01" step="0.01" placeholder="Cantidad" required>
            </div>
            <div class="form-group">
              <label for="obsMov">Observaciones</label>
              <textarea id="obsMov" placeholder="Observaciones" rows="3"></textarea>
            </div>
          </div>
          <div class="actions">
            <button type="submit" class="btn btn-success">Guardar</button>
            <button type="button" class="btn btn-secondary" onclick="limpiarFormMovimiento()">Limpiar</button>
          </div>
        </form>
        <div id="msgMov"></div>
      </div>
    </div>
  </div>
</div>

<!-- INVENTARIO -->
<div id="inventario" class="tab-content">
  <div class="content-header">
    <h2>Inventario</h2>
  </div>
  <div class="content-body">
    <div class="card">
      <div class="card-header">Stock Actual</div>
      <div class="card-body">
        <div class="actions">
          <button class="btn btn-primary" onclick="mostrarStock()">Actualizar</button>
          <button class="btn btn-success" onclick="exportarStock()">Exportar CSV</button>
          <button class="btn btn-warning" onclick="mostrarAlertas()">Solo Alertas</button>
        </div>
        <div id="loading" class="loading">Cargando...</div>
        <div class="table-container">
          <div id="stockTable"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- BUSCAR PRODUCTO -->
<div id="buscar" class="tab-content">
  <div class="content-header">
    <h2>Buscar Producto</h2>
  </div>
  <div class="content-body">
    <div class="card">
      <div class="card-header">Buscar por CÃ³digo o Nombre</div>
      <div class="card-body">
        <div class="form-grid">
          <div class="form-group">
            <label for="buscarTexto">CÃ³digo o Nombre</label>
            <input id="buscarTexto" type="text" placeholder="Buscar..." onkeyup="buscarEnTiempoReal()">
          </div>
        </div>
        <div class="actions">
          <button class="btn btn-primary" onclick="buscarProducto()">Buscar</button>
          <button class="btn btn-secondary" onclick="limpiarBusqueda()">Limpiar</button>
        </div>
        <div id="resultadosBusqueda"></div>
      </div>
    </div>
  </div>
</div>

<!-- REPORTES -->
<div id="reportes" class="tab-content">
  <div class="content-header">
    <h2>ğŸ“Š Reportes Avanzados</h2>
  </div>
  <div class="content-body">
    <div class="card">
      <div class="card-header">ğŸ” Filtros de BÃºsqueda</div>
      <div class="card-body">
        <div class="form-grid">
          <div class="form-group">
            <label for="fechaDesde">ğŸ“… Desde</label>
            <input id="fechaDesde" type="date" required>
          </div>
          <div class="form-group">
            <label for="fechaHasta">ğŸ“… Hasta</label>
            <input id="fechaHasta" type="date" required>
          </div>
          <div class="form-group">
            <label for="filtroTipo">ğŸ”„ Tipo de Movimiento</label>
            <select id="filtroTipo" onchange="manejarCambioTipoReporte()">
              <option value="">Todos los movimientos</option>
              <option value="INGRESO">ğŸ“¥ Ingresos</option>
              <option value="SALIDA">ğŸ“¤ Salidas</option>
              <option value="VENTA">ğŸ’° Ventas</option>
              <option value="AJUSTE_POSITIVO">â• Ajustes Positivos</option>
              <option value="AJUSTE_NEGATIVO">â– Ajustes Negativos</option>
            </select>
          </div>
          <div class="form-group">
            <label for="filtroUbicacion">ğŸ“ UbicaciÃ³n</label>
            <select id="filtroUbicacion">
              <option value="">Todas las ubicaciones</option>
            </select>
          </div>
          <div class="form-group">
            <label for="filtroProducto">ğŸ“¦ Producto</label>
            <select id="filtroProducto">
              <option value="">Todos los productos</option>
            </select>
          </div>
          <div class="form-group" id="filtroVendedorGroup" style="display: none;">
            <label for="filtroVendedor">ğŸ‘¤ Vendedor</label>
            <select id="filtroVendedor">
              <option value="">Todos los vendedores</option>
            </select>
          </div>
        </div>
        <div class="actions">
          <button class="btn btn-primary" onclick="mostrarHistorial()">ğŸ” Generar Reporte</button>
          <button class="btn btn-success" onclick="exportarReporte()">ğŸ“¥ Exportar CSV</button>
          <button class="btn btn-secondary" onclick="limpiarFiltrosReporte()">ğŸ”„ Limpiar Filtros</button>
        </div>
        <div id="resumenReporte" style="margin-top: 15px;"></div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">ğŸ“‹ Resultados</div>
      <div class="card-body">
        <div class="table-container">
          <div id="historialTable"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- CONFIGURACIÃ“N -->
<div id="configuracion" class="tab-content">
  <div class="content-header">
    <h2>ConfiguraciÃ³n</h2>
  </div>
  <div class="content-body">
    <div class="card">
      <div class="card-header">Herramientas del Sistema</div>
      <div class="card-body">
        <div class="actions">
          <button class="btn btn-info" onclick="validarIntegridad()">Validar Integridad</button>
          <button class="btn btn-success" onclick="inicializarSistema()">Inicializar Sistema</button>
          <button class="btn btn-warning" onclick="limpiarTodosFormularios()">Limpiar Formularios</button>
        </div>
        <div id="configResults"></div>
      </div>
    </div>
  </div>


</div>
<!-- DASHBOARD ANALÃTICO -->
<div id="analytics" class="tab-content">
  <div class="content-header">
    <h2>ğŸ“Š Dashboard AnalÃ­tico</h2>
  </div>

  <div class="card">
    <div class="card-body">
      <div id="analyticsContainer"></div>
    </div>
  </div>
</div>